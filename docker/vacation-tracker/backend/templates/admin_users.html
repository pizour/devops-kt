{% extends "base.html" %}

{% block content %}
  <h1>User management</h1>
  <p>As an admin you can reset passwords for users and remove accounts (including their bookings).</p>

  {% if users %}
    <table class="calendar-grid" style="margin-top: 0.5rem;">
      <thead>
        <tr>
          <th>Username</th>
          <th>Created (UTC)</th>
          <th>Admin</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for user in users %}
          <tr>
            <td>{{ user.username }}</td>
            <td>{{ user.created_at }}</td>
            <td>{{ "Yes" if user.is_admin else "No" }}</td>
            <td style="text-align: center;">
              <a
                href="{{ url_for('admin_change_user_password', username=user.username) }}"
                class="button-secondary"
              >
                Reset password
              </a>
              <form
                method="post"
                action="{{ url_for('admin_set_admin', username=user.username) }}"
                style="display:inline; margin-left: 0.25rem;"
              >
                {% if user.is_admin %}
                  <input type="hidden" name="action" value="revoke">
                  <button type="submit">Remove admin</button>
                {% else %}
                  <input type="hidden" name="action" value="grant">
                  <button type="submit">Grant admin</button>
                {% endif %}
              </form>
              <a
                href="{{ url_for('admin_delete_user', username=user.username) }}"
                class="button-danger"
                style="margin-left: 0.25rem;"
              >
                Remove user
              </a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p style="font-size: 0.9rem; color: #6b7280;">No users found.</p>
  {% endif %}
{% endblock %}
